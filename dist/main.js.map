{"version":3,"file":"main.js","mappings":"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","sources":["webpack://NeatJS/webpack/universalModuleDefinition","webpack://NeatJS/./src/calculations/Calculator.ts","webpack://NeatJS/./src/calculations/Connection.ts","webpack://NeatJS/./src/calculations/Node.ts","webpack://NeatJS/./src/calculations/index.ts","webpack://NeatJS/./src/dataStructures/index.ts","webpack://NeatJS/./src/dataStructures/randomHashSet.ts","webpack://NeatJS/./src/dataStructures/randomSelector.ts","webpack://NeatJS/./src/genome/connectionGene.ts","webpack://NeatJS/./src/genome/gene.ts","webpack://NeatJS/./src/genome/genome.ts","webpack://NeatJS/./src/genome/index.ts","webpack://NeatJS/./src/genome/nodeGene.ts","webpack://NeatJS/./src/index.ts","webpack://NeatJS/./src/neat/client.ts","webpack://NeatJS/./src/neat/index.ts","webpack://NeatJS/./src/neat/neat.ts","webpack://NeatJS/./src/neat/species.ts","webpack://NeatJS/webpack/bootstrap","webpack://NeatJS/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NeatJS\"] = factory();\n\telse\n\t\troot[\"NeatJS\"] = factory();\n})(self, () => {\nreturn ","import { ConnectionGene, Genome, NodeGene } from '../genome';\nimport { Node } from './Node';\nimport { Connection } from './Connection';\n\nexport class Calculator {\n    #inputNodes: Array<Node> = [];\n    #hiddenNodes: Array<Node> = [];\n    #outputNodes: Array<Node> = [];\n\n    constructor(genome: Genome) {\n        const nodes = genome.nodes;\n        const connections = genome.connections;\n\n        const nodeHashmap: Map<number, Node> = new Map();\n\n        for (let i = 0; i < nodes.data.length; i += 1) {\n            const n = nodes.data[i];\n            if (n instanceof ConnectionGene) continue;\n            const node: Node = new Node(n.x);\n            nodeHashmap.set(n.innovationNumber, node);\n\n            if (n.x <= 0.1) {\n                this.#inputNodes.push(node);\n            } else if (n.x >= 0.9) {\n                this.#outputNodes.push(node);\n            } else {\n                this.#hiddenNodes.push(node);\n            }\n        }\n        this.#hiddenNodes.sort((a, b) => {\n            return a.compereTo(b);\n        });\n\n        for (let i = 0; i < connections.data.length; i += 1) {\n            const c = connections.data[i];\n            if (c instanceof NodeGene) continue;\n\n            const from: NodeGene = c.from;\n            const to: NodeGene = c.to;\n\n            const nodeFrom = nodeHashmap.get(from.innovationNumber);\n            const nodeTo = nodeHashmap.get(to.innovationNumber);\n            if (!nodeFrom || !nodeTo) continue;\n\n            const con = new Connection(nodeFrom, nodeTo);\n            con.weight = c.weight;\n            con.enabled = c.enabled;\n\n            nodeTo.connections.push(con);\n        }\n    }\n\n    calculate(input: Array<number>): Array<number> {\n        if (input.length !== this.#inputNodes.length) throw new Error('Data dosent fit');\n        for (let i = 0; i < this.#inputNodes.length; i++) {\n            this.#inputNodes[i].output = input[i];\n        }\n        for (let i = 0; i < this.#hiddenNodes.length; i++) {\n            this.#hiddenNodes[i].calculate();\n        }\n        const output = new Array<number>(this.#outputNodes.length);\n        for (let i = 0; i < this.#outputNodes.length; i++) {\n            this.#outputNodes[i].calculate();\n            output[i] = this.#outputNodes[i].output;\n        }\n        return output;\n    }\n}\n","import { Node } from './Node';\n\nexport class Connection {\n    #from: Node;\n    #to: Node;\n    #weight = 0;\n    #enabled = true;\n\n    constructor(from: Node, to: Node) {\n        this.#from = from;\n        this.#to = to;\n    }\n\n    get from(): Node {\n        return this.#from;\n    }\n\n    set from(value: Node) {\n        this.#from = value;\n    }\n\n    get to(): Node {\n        return this.#to;\n    }\n\n    set to(value: Node) {\n        this.#to = value;\n    }\n\n    get weight(): number {\n        return this.#weight;\n    }\n\n    set weight(value: number) {\n        this.#weight = value;\n    }\n\n    get enabled(): boolean {\n        return this.#enabled;\n    }\n\n    set enabled(value: boolean) {\n        this.#enabled = value;\n    }\n}\n","import { Connection } from './Connection';\n\nexport class Node {\n    #x: number;\n    #output = 0;\n    #connections: Array<Connection> = [];\n\n    constructor(x: number) {\n        this.#x = x;\n    }\n\n    get x(): number {\n        return this.#x;\n    }\n\n    set x(value: number) {\n        this.#x = value;\n    }\n\n    get output(): number {\n        return this.#output;\n    }\n\n    set output(value: number) {\n        this.#output = value;\n    }\n\n    get connections(): Array<Connection> {\n        return this.#connections;\n    }\n\n    set connections(value: Array<Connection>) {\n        this.#connections = value;\n    }\n\n    #activation(sum: number): number {\n        return 1 / (1 + Math.exp(-sum));\n    }\n\n    calculate() {\n        let sum = 0;\n        for (let i = 0; i < this.#connections.length; i += 1) {\n            const c = this.#connections[i];\n            if (c.enabled) {\n                sum += c.weight * c.from.output;\n            }\n        }\n        this.#output = this.#activation(sum);\n    }\n\n    compereTo(node: Node): number {\n        if (this.x > node.x) {\n            return 1;\n        } else if (this.x < node.x) {\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n}\n","export * from './Node';\nexport * from './Connection';\nexport * from './Calculator';\n","export * from './randomHashSet';\nexport * from './randomSelector';\n","import { ConnectionGene, NodeGene } from '../genome';\r\n\r\nexport class RandomHashSet {\r\n    #set: Set<NodeGene | ConnectionGene>;\r\n    #data: Array<NodeGene | ConnectionGene>;\r\n\r\n    constructor() {\r\n        this.#set = new Set();\r\n        this.#data = [];\r\n    }\r\n\r\n    contains(gene: NodeGene | ConnectionGene): boolean {\r\n        let contains = false;\r\n        for (let i = 0; i < this.data.length; i += 1) {\r\n            if (this.data[i].innovationNumber === gene.innovationNumber) {\r\n                contains = true;\r\n            }\r\n        }\r\n        return contains;\r\n    }\r\n\r\n    randomElement(): NodeGene | ConnectionGene | null {\r\n        if (!this.#set.size) {\r\n            return null;\r\n        }\r\n        return this.#data[Math.floor(this.#data.length * Math.random())];\r\n    }\r\n\r\n    add(gene: NodeGene | ConnectionGene) {\r\n        if (!this.contains(gene)) {\r\n            this.#set.add(gene);\r\n            this.#data.push(gene);\r\n        }\r\n    }\r\n\r\n    addSorted(gene: NodeGene | ConnectionGene) {\r\n        if (!this.contains(gene)) {\r\n            for (let i = 0; i < this.size(); i++) {\r\n                const innovation = this.get(i).innovationNumber;\r\n                if (gene.innovationNumber < innovation) {\r\n                    this.#data.splice(i, 0, gene);\r\n                    this.#set.add(gene);\r\n                    return;\r\n                }\r\n            }\r\n            this.#set.add(gene);\r\n            this.#data.push(gene);\r\n        }\r\n    }\r\n\r\n    size(): number {\r\n        return this.#data.length;\r\n    }\r\n\r\n    clear() {\r\n        this.#set.clear();\r\n        this.#data = [];\r\n    }\r\n\r\n    get(index: number): NodeGene | ConnectionGene {\r\n        return this.#data[index];\r\n    }\r\n\r\n    remove(arg: number | ConnectionGene) {\r\n        if (arg instanceof ConnectionGene) {\r\n            const index = this.#data.indexOf(arg);\r\n            this.#data.splice(index, 1);\r\n            this.#set.delete(arg);\r\n        } else {\r\n            if (arg < 0 || arg >= this.#set.size) {\r\n                return;\r\n            }\r\n            this.#set.delete(this.#data[arg]);\r\n            this.#data.splice(arg, 1);\r\n        }\r\n    }\r\n\r\n    get data(): Array<NodeGene | ConnectionGene> {\r\n        return this.#data;\r\n    }\r\n}\r\n","import { Species } from '../neat';\r\n\r\nexport class RandomSelector {\r\n    #objects: Array<Species> = [];\r\n    #survivors: number;\r\n    #totalScore = 0;\r\n\r\n    constructor(survivors: number) {\r\n        this.#survivors = survivors;\r\n    }\r\n\r\n    add(object: Species) {\r\n        this.#objects.push(object);\r\n        this.#totalScore += object.score;\r\n        this.#objects.sort((a, b) => {\r\n            return a.score > b.score ? -1 : 1;\r\n        });\r\n    }\r\n\r\n    random(): Species {\r\n        const randomScore = Math.random() * this.#totalScore * this.#survivors;\r\n        let scoreIndex = 0;\r\n        for (let i = 0; i < this.#objects.length; i++) {\r\n            scoreIndex += this.#objects[i].score;\r\n            if (scoreIndex >= randomScore) {\r\n                return this.#objects[i];\r\n            }\r\n        }\r\n        throw new Error('random Species not found');\r\n    }\r\n\r\n    reset() {\r\n        this.#objects = [];\r\n        this.#totalScore = 0;\r\n    }\r\n}\r\n","import { Gene } from './gene';\r\nimport { NodeGene } from './nodeGene';\r\nimport { Neat } from '../neat';\r\n\r\nexport class ConnectionGene extends Gene {\r\n    #from: NodeGene;\r\n    #to: NodeGene;\r\n    #weight = 0;\r\n    #enabled = true;\r\n\r\n    #replaceIndex = 0;\r\n\r\n    constructor(innovationNumber: number, from: NodeGene, to: NodeGene) {\r\n        super(innovationNumber);\r\n        this.#from = from;\r\n        this.#to = to;\r\n    }\r\n\r\n    get replaceIndex(): number {\r\n        return this.#replaceIndex;\r\n    }\r\n\r\n    set replaceIndex(value: number) {\r\n        this.#replaceIndex = value;\r\n    }\r\n\r\n    get from(): NodeGene {\r\n        return this.#from;\r\n    }\r\n\r\n    set from(value: NodeGene) {\r\n        this.#from = value;\r\n    }\r\n\r\n    get to(): NodeGene {\r\n        return this.#to;\r\n    }\r\n\r\n    set to(value: NodeGene) {\r\n        this.#to = value;\r\n    }\r\n\r\n    get weight(): number {\r\n        return this.#weight;\r\n    }\r\n\r\n    set weight(value: number) {\r\n        this.#weight = value;\r\n    }\r\n\r\n    get enabled(): boolean {\r\n        return this.#enabled;\r\n    }\r\n\r\n    set enabled(value: boolean) {\r\n        this.#enabled = value;\r\n    }\r\n\r\n    getHashKey(): string {\r\n        return `${this.from.innovationNumber}-${this.from.x}-${this.to.innovationNumber}-${this.to.x}`;\r\n    }\r\n\r\n    equals(obj: unknown): boolean {\r\n        if (!(obj instanceof ConnectionGene)) return false;\r\n\r\n        return this.from.equals(obj.from) && this.to.equals(obj.to);\r\n    }\r\n\r\n    hashCode(): number {\r\n        return this.from.innovationNumber * Neat.MAX_NODES + this.to.innovationNumber;\r\n    }\r\n}\r\n","export class Gene {\n    #innovationNumber: number;\n\n    constructor(innovationNumber: number) {\n        this.#innovationNumber = innovationNumber;\n    }\n\n    get innovationNumber(): number {\n        return this.#innovationNumber;\n    }\n\n    set innovationNumber(value: number) {\n        this.#innovationNumber = value;\n    }\n}\n","import { RandomHashSet } from '../dataStructures';\r\nimport { Neat } from '../neat';\r\nimport { ConnectionGene } from './connectionGene';\r\nimport { NodeGene } from './nodeGene';\r\n\r\nexport class Genome {\r\n    #connections: RandomHashSet = new RandomHashSet();\r\n    #nodes: RandomHashSet = new RandomHashSet();\r\n    #neat: Neat;\r\n\r\n    constructor(neat: Neat) {\r\n        this.#neat = neat;\r\n    }\r\n\r\n    get connections(): RandomHashSet {\r\n        return this.#connections;\r\n    }\r\n\r\n    get nodes(): RandomHashSet {\r\n        return this.#nodes;\r\n    }\r\n\r\n    get neat(): Neat {\r\n        return this.#neat;\r\n    }\r\n\r\n    distance(g2: Genome): number {\r\n        let g1: Genome = this;\r\n\r\n        const higGene1: ConnectionGene | NodeGene = g1.connections.get(g1.connections.size() - 1);\r\n        const higGene2: ConnectionGene | NodeGene = g2.connections.get(g2.connections.size() - 1);\r\n\r\n        const higInnovationG1 = higGene1 instanceof ConnectionGene ? higGene1.innovationNumber : 0;\r\n        const higInnovationG2 = higGene2 instanceof ConnectionGene ? higGene2.innovationNumber : 0;\r\n        if (higInnovationG1 < higInnovationG2) {\r\n            const tempG = g1;\r\n            g1 = g2;\r\n            g2 = tempG;\r\n        }\r\n\r\n        let indexG1 = 0;\r\n        let indexG2 = 0;\r\n\r\n        let disjoint = 0;\r\n        let weightDiff = 0;\r\n        let similar = 0;\r\n        while (indexG1 < g1.connections.size() && indexG2 < g2.connections.size()) {\r\n            const gene1: ConnectionGene | NodeGene = g1.connections.get(indexG1);\r\n            const gene2: ConnectionGene | NodeGene = g2.connections.get(indexG2);\r\n            if (!(gene1 instanceof ConnectionGene) || !(gene2 instanceof ConnectionGene)) {\r\n                throw new Error('gene is not a ConnectionGene');\r\n            }\r\n            const inn1: number = gene1.innovationNumber;\r\n            const inn2: number = gene2.innovationNumber;\r\n\r\n            if (inn1 > inn2) {\r\n                indexG2++;\r\n                disjoint++;\r\n            } else if (inn1 < inn2) {\r\n                indexG1++;\r\n                disjoint++;\r\n            } else {\r\n                indexG1++;\r\n                indexG2++;\r\n                similar++;\r\n                weightDiff += Math.abs(gene1.weight - gene2.weight);\r\n            }\r\n        }\r\n\r\n        weightDiff /= similar || 1;\r\n\r\n        const excess = g1.connections.size() - indexG1;\r\n        let N = Math.max(g1.connections.size(), g2.connections.size());\r\n        N = N < this.#neat.CT ? 1 : N;\r\n\r\n        return (this.#neat.C1 * excess) / N + (this.#neat.C2 * disjoint) / N + this.#neat.C3 * weightDiff;\r\n    }\r\n\r\n    static crossOver(g1: Genome, g2: Genome): Genome {\r\n        const genome: Genome = g1.neat.emptyGenome();\r\n\r\n        let indexG1 = 0;\r\n        let indexG2 = 0;\r\n\r\n        while (indexG1 < g1.connections.size() && indexG2 < g2.connections.size()) {\r\n            const gene1 = g1.connections.get(indexG1);\r\n            const gene2 = g2.connections.get(indexG2);\r\n            if (!(gene1 instanceof ConnectionGene) || !(gene2 instanceof ConnectionGene)) {\r\n                throw new Error('gene is not a ConnectionGene');\r\n            }\r\n            const inn1: number = gene1.innovationNumber;\r\n            const inn2: number = gene2.innovationNumber;\r\n            let addedCon: ConnectionGene | null = null;\r\n            if (inn1 > inn2) {\r\n                indexG2++;\r\n            } else if (inn1 < inn2) {\r\n                addedCon = Neat.getConnection(gene1);\r\n                indexG1++;\r\n            } else {\r\n                if (gene1.enabled || gene2.enabled) {\r\n                    if (Math.random() > 0.4) {\r\n                        addedCon = Neat.getConnection(gene1);\r\n                    } else {\r\n                        addedCon = Neat.getConnection(gene2);\r\n                    }\r\n                }\r\n                indexG1++;\r\n                indexG2++;\r\n            }\r\n            if (!(addedCon instanceof ConnectionGene)) {\r\n                continue;\r\n            }\r\n            if (!g1.neat.optimization || Math.random() < 0.99 || g1.nodes.size() < g1.neat.CT) {\r\n                genome.connections.addSorted(addedCon);\r\n            }\r\n        }\r\n        while (indexG1 < g1.connections.size()) {\r\n            const gene1 = g1.connections.get(indexG1);\r\n            if (!(gene1 instanceof ConnectionGene)) {\r\n                throw new Error('gene is not a ConnectionGene');\r\n            }\r\n\r\n            if (!g1.neat.optimization || Math.random() < 0.99 || g1.nodes.size() < g1.neat.CT) {\r\n                genome.connections.addSorted(Neat.getConnection(gene1));\r\n            }\r\n            indexG1++;\r\n        }\r\n        for (let i = 0; i < genome.connections.data.length; i++) {\r\n            const conn = genome.connections.get(i);\r\n            if (!(conn instanceof ConnectionGene)) {\r\n                throw new Error('gene is not a ConnectionGene');\r\n            }\r\n            genome.nodes.add(conn.from);\r\n            genome.nodes.add(conn.to);\r\n        }\r\n\r\n        return genome;\r\n    }\r\n\r\n    mutateLink(): ConnectionGene | null {\r\n        let geneA = this.#nodes.randomElement();\r\n        let geneB = this.#nodes.randomElement();\r\n\r\n        if (!(geneA instanceof NodeGene) || !(geneB instanceof NodeGene)) {\r\n            return null;\r\n        }\r\n\r\n        while (geneB instanceof NodeGene && geneA.x === geneB.x) {\r\n            geneB = this.#nodes.randomElement();\r\n        }\r\n\r\n        if (!(geneB instanceof NodeGene)) {\r\n            return null;\r\n        }\r\n\r\n        if (geneA.x > geneB.x) {\r\n            const temp = geneA;\r\n            geneA = geneB;\r\n            geneB = temp;\r\n        }\r\n        let exists = false;\r\n        this.#connections.data.forEach(item => {\r\n            if (item instanceof NodeGene) return;\r\n            if (item.from === geneA && item.to === geneB) {\r\n                exists = true;\r\n            }\r\n        });\r\n        if (exists) {\r\n            return null;\r\n        }\r\n\r\n        const con: ConnectionGene = this.#neat.getConnection(geneA, geneB);\r\n        con.weight = (Math.random() * 2 - 1) * this.#neat.WEIGHT_RANDOM_STRENGTH;\r\n\r\n        this.#connections.addSorted(con);\r\n        return con;\r\n    }\r\n\r\n    mutateNode(): NodeGene | null {\r\n        const con = this.#connections.randomElement();\r\n        if (!(con instanceof ConnectionGene)) {\r\n            return null;\r\n        }\r\n\r\n        const from: NodeGene = con.from;\r\n        const to: NodeGene = con.to;\r\n        const replaceIndex = this.#neat.getReplaceIndex(from, to);\r\n        let middle: NodeGene;\r\n        if (replaceIndex === 0) {\r\n            middle = this.#neat.getNode();\r\n            middle.x = (from.x + to.x) / 2;\r\n            middle.y = (from.y + to.y) / 2 + Math.random() * 0.6 - 0.3;\r\n            middle.y = middle.y < 0.1 ? 0.1 : middle.y > 0.9 ? 0.9 : middle.y;\r\n            this.#neat.setReplaceIndex(from, to, middle.innovationNumber);\r\n        } else {\r\n            middle = this.#neat.getNode(replaceIndex);\r\n        }\r\n\r\n        const con1: ConnectionGene = this.#neat.getConnection(from, middle);\r\n        const con2: ConnectionGene = this.#neat.getConnection(middle, to);\r\n        let exists1 = false;\r\n        let exists2 = false;\r\n        this.#connections.data.forEach(item => {\r\n            if (item instanceof NodeGene) return;\r\n            if (item.from === from && item.to === middle) {\r\n                exists1 = true;\r\n            }\r\n            if (item.from === middle && item.to === to) {\r\n                exists2 = true;\r\n            }\r\n        });\r\n        if (!exists1) {\r\n            con1.weight = 1;\r\n            con2.weight = con.weight;\r\n            this.#connections.addSorted(con1);\r\n        }\r\n        if (!exists2) {\r\n            con2.enabled = con.enabled;\r\n            this.#connections.addSorted(con2);\r\n        }\r\n        if (!exists1 || !exists2) {\r\n            con.enabled = false;\r\n        }\r\n\r\n        this.#nodes.add(middle);\r\n        return middle;\r\n    }\r\n\r\n    mutateWeightShift(): ConnectionGene | null {\r\n        const con = this.#connections.randomElement();\r\n        if (!(con instanceof ConnectionGene)) {\r\n            return null;\r\n        }\r\n        let newWeight = con.weight;\r\n        while (newWeight === con.weight) {\r\n            newWeight = con.weight + (Math.random() * 2 - 1) * this.#neat.WEIGHT_SHIFT_STRENGTH;\r\n        }\r\n        con.weight = newWeight;\r\n        return con;\r\n    }\r\n\r\n    mutateWeightRandom(): ConnectionGene | null {\r\n        const con = this.#connections.randomElement();\r\n        if (!(con instanceof ConnectionGene)) {\r\n            return null;\r\n        }\r\n\r\n        let newWeight = con.weight || this.#neat.WEIGHT_RANDOM_STRENGTH;\r\n        while (newWeight === con.weight) {\r\n            newWeight = (Math.random() * newWeight * 2 - newWeight) * this.#neat.WEIGHT_RANDOM_STRENGTH;\r\n        }\r\n        con.weight = newWeight;\r\n        return con;\r\n    }\r\n\r\n    mutateLinkToggle(): ConnectionGene | null {\r\n        const con = this.#connections.randomElement();\r\n        if (!(con instanceof ConnectionGene)) {\r\n            return null;\r\n        }\r\n        con.enabled = !con.enabled;\r\n        return con;\r\n    }\r\n\r\n    mutate() {\r\n        let prob: number;\r\n\r\n        prob = this.#neat.PROBABILITY_MUTATE_NODES;\r\n        prob = prob > this.#connections.size() ? this.#connections.size() : prob;\r\n        while (prob > Math.random()) {\r\n            prob--;\r\n            this.mutateNode();\r\n        }\r\n\r\n        prob = this.#neat.PROBABILITY_MUTATE_LINK;\r\n        prob = prob < this.#neat.CT ? this.#neat.CT : prob;\r\n        while (prob > Math.random()) {\r\n            prob--;\r\n            this.mutateLink();\r\n        }\r\n\r\n        prob = this.#neat.PROBABILITY_MUTATE_TOGGLE_LINK;\r\n        prob = prob > this.#connections.size() ? this.#connections.size() : prob;\r\n        while (prob > Math.random()) {\r\n            prob--;\r\n            this.mutateLinkToggle();\r\n        }\r\n\r\n        prob = this.#neat.PROBABILITY_MUTATE_WEIGHT_RANDOM;\r\n        prob = prob > this.#connections.size() ? this.#connections.size() : prob;\r\n        while (prob > Math.random()) {\r\n            prob--;\r\n            this.mutateWeightRandom();\r\n        }\r\n\r\n        prob = this.#neat.PROBABILITY_MUTATE_WEIGHT_SHIFT;\r\n        prob = prob > this.#connections.size() ? this.#connections.size() : prob;\r\n        while (prob > Math.random()) {\r\n            prob--;\r\n            this.mutateWeightShift();\r\n        }\r\n    }\r\n}\r\n","export * from './gene';\nexport * from './nodeGene';\nexport * from './connectionGene';\nexport * from './genome';\n","import { Gene } from './gene';\n\nexport class NodeGene extends Gene {\n    #x = 0;\n    #y = 0;\n\n    constructor(innovationNumber: number) {\n        super(innovationNumber);\n    }\n\n    get x(): number {\n        return this.#x;\n    }\n\n    set x(value: number) {\n        this.#x = value;\n    }\n\n    get y(): number {\n        return this.#y;\n    }\n\n    set y(value: number) {\n        this.#y = value;\n    }\n\n    equals(obj: unknown): boolean {\n        if (!(obj instanceof NodeGene)) return false;\n        return this.innovationNumber === obj.innovationNumber;\n    }\n\n    hashCode(): number {\n        return this.innovationNumber;\n    }\n}\n","export * from './neat';\n","import { Genome } from '../genome';\r\nimport { Species } from './species';\r\nimport { Calculator } from '../calculations';\r\n\r\nexport class Client {\r\n    #genome: Genome;\r\n    #score = 0;\r\n    #bestScore = false;\r\n    #species: Species | null;\r\n    #calculator: Calculator | null;\r\n\r\n    constructor(genome: Genome) {\r\n        this.#genome = genome;\r\n        this.#calculator = null;\r\n        this.#species = null;\r\n    }\r\n\r\n    get bestScore(): boolean {\r\n        return this.#bestScore;\r\n    }\r\n\r\n    set bestScore(value: boolean) {\r\n        this.#bestScore = value;\r\n    }\r\n\r\n    get genome(): Genome {\r\n        return this.#genome;\r\n    }\r\n\r\n    set genome(value: Genome) {\r\n        this.#genome = value;\r\n    }\r\n\r\n    get score(): number {\r\n        return this.#score;\r\n    }\r\n\r\n    set score(value: number) {\r\n        this.#score = value;\r\n    }\r\n\r\n    get species(): Species | null {\r\n        return this.#species;\r\n    }\r\n\r\n    set species(value: Species | null) {\r\n        this.#species = value;\r\n    }\r\n\r\n    generateCalculator() {\r\n        this.#calculator = new Calculator(this.#genome);\r\n    }\r\n\r\n    distance(client: Client): number {\r\n        return this.genome.distance(client.genome);\r\n    }\r\n\r\n    mutate() {\r\n        if (this.bestScore) {\r\n            return;\r\n        }\r\n        this.genome.mutate();\r\n    }\r\n\r\n    calculate(input: Array<number>): Array<number> {\r\n        if (!this.#calculator) {\r\n            this.generateCalculator();\r\n        }\r\n        return this.#calculator?.calculate(input) || [];\r\n    }\r\n}\r\n","export * from './neat';\nexport * from './species';\nexport * from './client';\n","import { ConnectionGene, Genome, NodeGene } from '../genome';\r\nimport { RandomHashSet, RandomSelector } from '../dataStructures';\r\nimport { Client } from './client';\r\nimport { Species } from './species';\r\n\r\nexport class Neat {\r\n    static get MAX_NODES(): number {\r\n        return Math.pow(2, 20);\r\n    }\r\n\r\n    #C1 = 1;\r\n    #C2 = 1;\r\n    #C3 = 0.1;\r\n\r\n    #CP = 10;\r\n    #CT = 1;\r\n\r\n    #WEIGHT_SHIFT_STRENGTH = 5;\r\n    #WEIGHT_RANDOM_STRENGTH = 10;\r\n\r\n    #SURVIVORS = 0.8;\r\n\r\n    #PROBABILITY_MUTATE_WEIGHT_SHIFT = 4;\r\n    #PROBABILITY_MUTATE_TOGGLE_LINK = 0.5;\r\n    #PROBABILITY_MUTATE_WEIGHT_RANDOM = 0.2;\r\n    #PROBABILITY_MUTATE_LINK = 0.05;\r\n    #PROBABILITY_MUTATE_NODES = 0.05;\r\n\r\n    #inputNodes = 0;\r\n    #outputNodes = 0;\r\n    #maxClients = 0;\r\n\r\n    #evolveCounts = 0;\r\n\r\n    #clients: Array<Client> = [];\r\n    #species: Array<Species> = [];\r\n\r\n    #allConnections: Map<string, ConnectionGene> = new Map<string, ConnectionGene>();\r\n    #allNodes: RandomHashSet = new RandomHashSet();\r\n\r\n    #optimization = false;\r\n\r\n    constructor(inputNodes: number, outputNodes: number, clients: number) {\r\n        this.reset(inputNodes, outputNodes, clients);\r\n    }\r\n\r\n    get optimization(): boolean {\r\n        return this.#optimization;\r\n    }\r\n\r\n    set optimization(value: boolean) {\r\n        this.#optimization = value;\r\n    }\r\n\r\n    get clients(): Array<Client> {\r\n        return this.#clients;\r\n    }\r\n\r\n    get allConnections(): Map<string, ConnectionGene> {\r\n        return this.#allConnections;\r\n    }\r\n    get allNodes(): RandomHashSet {\r\n        return this.#allNodes;\r\n    }\r\n\r\n    get WEIGHT_SHIFT_STRENGTH(): number {\r\n        return this.#WEIGHT_SHIFT_STRENGTH;\r\n    }\r\n\r\n    get WEIGHT_RANDOM_STRENGTH(): number {\r\n        return this.#WEIGHT_RANDOM_STRENGTH;\r\n    }\r\n\r\n    get PROBABILITY_MUTATE_LINK(): number {\r\n        return this.#PROBABILITY_MUTATE_LINK;\r\n    }\r\n\r\n    get PROBABILITY_MUTATE_NODES(): number {\r\n        return this.#PROBABILITY_MUTATE_NODES;\r\n    }\r\n\r\n    get PROBABILITY_MUTATE_WEIGHT_SHIFT(): number {\r\n        return this.#PROBABILITY_MUTATE_WEIGHT_SHIFT;\r\n    }\r\n\r\n    get PROBABILITY_MUTATE_WEIGHT_RANDOM(): number {\r\n        return this.#PROBABILITY_MUTATE_WEIGHT_RANDOM;\r\n    }\r\n\r\n    get PROBABILITY_MUTATE_TOGGLE_LINK(): number {\r\n        return this.#PROBABILITY_MUTATE_TOGGLE_LINK;\r\n    }\r\n\r\n    set CT(value: number) {\r\n        this.#CT = value;\r\n    }\r\n\r\n    get CT(): number {\r\n        return this.#CT;\r\n    }\r\n\r\n    get CP(): number {\r\n        return this.#CP;\r\n    }\r\n\r\n    get C1(): number {\r\n        return this.#C1;\r\n    }\r\n\r\n    get C2(): number {\r\n        return this.#C2;\r\n    }\r\n\r\n    get C3(): number {\r\n        return this.#C3;\r\n    }\r\n\r\n    reset(inputNodes: number, outputNodes: number, clients: number) {\r\n        this.#inputNodes = inputNodes;\r\n        this.#outputNodes = outputNodes;\r\n        this.#maxClients = clients;\r\n\r\n        this.#allConnections.clear();\r\n        this.#allNodes.clear();\r\n        this.#clients = [];\r\n\r\n        this.CT = (inputNodes + outputNodes) * 3;\r\n\r\n        for (let i = 0; i < this.#inputNodes; i += 1) {\r\n            const nodeGene: NodeGene = this.getNode();\r\n            nodeGene.x = 0.1;\r\n            nodeGene.y = (i + 1) / (this.#inputNodes + 1);\r\n        }\r\n\r\n        for (let i = 0; i < this.#outputNodes; i += 1) {\r\n            const nodeGene: NodeGene = this.getNode();\r\n            nodeGene.x = 0.9;\r\n            nodeGene.y = (i + 1) / (this.#outputNodes + 1);\r\n        }\r\n        for (let i = 0; i < this.#maxClients; i += 1) {\r\n            const c: Client = new Client(this.emptyGenome());\r\n            c.generateCalculator();\r\n            this.#clients.push(c);\r\n        }\r\n    }\r\n\r\n    setReplaceIndex(node1: NodeGene, node2: NodeGene, index: number) {\r\n        const connectionGene = new ConnectionGene(0, node1, node2);\r\n        const hashKey = connectionGene.getHashKey();\r\n        const foundCon = this.#allConnections.get(hashKey);\r\n        if (foundCon) {\r\n            foundCon.replaceIndex = index;\r\n        } else {\r\n            throw new Error('setReplaceIndex to no connection');\r\n        }\r\n    }\r\n    getReplaceIndex(node1: NodeGene, node2: NodeGene): number {\r\n        const connectionGene = new ConnectionGene(0, node1, node2);\r\n        const hashKey = connectionGene.getHashKey();\r\n        const foundCon = this.#allConnections.get(hashKey);\r\n        if (!foundCon) return 0;\r\n        return foundCon.replaceIndex;\r\n    }\r\n\r\n    emptyGenome(): Genome {\r\n        const genome: Genome = new Genome(this);\r\n        for (let i = 0; i < this.#inputNodes + this.#outputNodes; i += 1) {\r\n            genome.nodes.add(this.getNode(i + 1));\r\n        }\r\n        return genome;\r\n    }\r\n\r\n    static getConnection(con: ConnectionGene): ConnectionGene {\r\n        const connectionGene = new ConnectionGene(con.innovationNumber, con.from, con.to);\r\n        connectionGene.weight = con.weight;\r\n        connectionGene.enabled = con.enabled;\r\n        return connectionGene;\r\n    }\r\n\r\n    getConnection(node1: NodeGene, node2: NodeGene): ConnectionGene {\r\n        const connectionGene = new ConnectionGene(0, node1, node2);\r\n        const hashKey = connectionGene.getHashKey();\r\n        if (this.#allConnections.has(hashKey)) {\r\n            const foundCon = this.#allConnections.get(hashKey);\r\n            connectionGene.innovationNumber = foundCon ? foundCon.innovationNumber : 0;\r\n        } else {\r\n            this.#allConnections.set(hashKey, connectionGene);\r\n            connectionGene.innovationNumber = this.#allConnections.size + 1;\r\n        }\r\n\r\n        return connectionGene;\r\n    }\r\n\r\n    getNode(id?: number): NodeGene {\r\n        let nodeGene;\r\n        if (id && id <= this.#allNodes.size()) {\r\n            nodeGene = this.#allNodes.get(id - 1);\r\n            if (!(nodeGene instanceof NodeGene)) {\r\n                throw new Error('getNode returns not a NodeGene');\r\n            }\r\n        } else {\r\n            nodeGene = new NodeGene(this.#allNodes.size() + 1);\r\n            this.#allNodes.add(nodeGene);\r\n        }\r\n        return nodeGene;\r\n    }\r\n\r\n    evolve() {\r\n        this.#evolveCounts++;\r\n        if (this.#evolveCounts % 50 === 0) {\r\n            this.#optimization = true;\r\n        }\r\n        this.#setBestScore();\r\n        this.#genSpecies();\r\n        this.#kill();\r\n        this.#removeExtinct();\r\n        this.#reproduce();\r\n        this.#mutate();\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            this.#clients[i].generateCalculator();\r\n        }\r\n    }\r\n\r\n    printSpecies() {\r\n        for (let i = 0; i < this.#species.length; i += 1) {\r\n            console.log(this.#species[i].score, this.#species[i].size());\r\n        }\r\n    }\r\n\r\n    #mutate() {\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            this.#clients[i].mutate();\r\n        }\r\n    }\r\n\r\n    #reproduce() {\r\n        const selector = new RandomSelector(this.#SURVIVORS);\r\n        for (let i = 0; i < this.#species.length; i += 1) {\r\n            selector.add(this.#species[i]);\r\n        }\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            const c = this.#clients[i];\r\n            if (c.species === null) {\r\n                const s = selector.random();\r\n                c.genome = s.breed();\r\n                s.put(c, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    #removeExtinct() {\r\n        for (let i = this.#species.length - 1; i >= 0; i--) {\r\n            if (this.#species[i].size() <= 1 && !this.#species[i].clients[0].bestScore) {\r\n                this.#species[i].goExtinct();\r\n                this.#species.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    #kill() {\r\n        let complexity = 0;\r\n        this.#clients.forEach(item => {\r\n            const allCons = item.genome.nodes.size() + item.genome.connections.size();\r\n            complexity = complexity < allCons ? allCons : complexity;\r\n        });\r\n        for (let i = 0; i < this.#species.length; i += 1) {\r\n            this.#species[i].kill(this.#SURVIVORS, complexity);\r\n        }\r\n    }\r\n\r\n    #genSpecies() {\r\n        for (let i = 0; i < this.#species.length; i += 1) {\r\n            this.#species[i].reset(this.optimization);\r\n        }\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            const c = this.#clients[i];\r\n            if (c.species !== null) {\r\n                continue;\r\n            }\r\n\r\n            let found = false;\r\n            for (let k = 0; k < this.#species.length; k += 1) {\r\n                const s = this.#species[k];\r\n                if (s.put(c)) {\r\n                    found = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!found) {\r\n                this.#species.push(new Species(c));\r\n            }\r\n        }\r\n        for (let i = 0; i < this.#species.length; i += 1) {\r\n            this.#species[i].evaluateScore();\r\n        }\r\n    }\r\n    #setBestScore() {\r\n        let bestScore = 0;\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            this.#clients[i].bestScore = false;\r\n            bestScore = this.#clients[i].score > bestScore ? this.#clients[i].score : bestScore;\r\n        }\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            if (this.#clients[i].score === bestScore) {\r\n                this.#clients[i].bestScore = true;\r\n                return;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { Client } from './client';\r\nimport { Genome } from '../genome';\r\n\r\nexport class Species {\r\n    #clients: Array<Client> = [];\r\n    #representative: Client;\r\n    #score = 0;\r\n    #optimization = false;\r\n\r\n    constructor(client: Client) {\r\n        this.#representative = client;\r\n        this.#representative.species = this;\r\n        this.#clients.push(client);\r\n    }\r\n\r\n    get score(): number {\r\n        return this.#score;\r\n    }\r\n\r\n    get clients(): Array<Client> {\r\n        return this.#clients;\r\n    }\r\n\r\n    put(client: Client, force = false): boolean {\r\n        if (force || client.distance(this.#representative) < this.#representative.genome.neat.CP) {\r\n            client.species = this;\r\n            this.#clients.push(client);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    goExtinct() {\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            const c = this.#clients[i];\r\n            c.species = null;\r\n        }\r\n    }\r\n\r\n    evaluateScore() {\r\n        let value = 0;\r\n        for (let i = 0; i < this.#clients.length; i += 1) {\r\n            const c = this.#clients[i];\r\n            value += c.score;\r\n        }\r\n        this.#score = value / this.#clients.length;\r\n    }\r\n\r\n    #getRandomClient(): Client {\r\n        return this.#clients[Math.floor(Math.random() * this.#clients.length)];\r\n    }\r\n\r\n    reset(optimization: boolean) {\r\n        this.#optimization = optimization;\r\n        this.#representative = this.#getRandomClient();\r\n        this.goExtinct();\r\n        this.#clients = [];\r\n        this.#clients.push(this.#representative);\r\n        this.#representative.species = this;\r\n        this.#score = 0;\r\n    }\r\n\r\n    kill(survivors = 0.5, complexity: number) {\r\n        const cof = this.#optimization ? 1 : 0.5;\r\n\r\n        if (complexity) {\r\n            this.#clients.forEach(item => {\r\n                const allCons = item.genome.nodes.size() + item.genome.connections.size();\r\n                item.score += (Math.sqrt(complexity - allCons) / complexity) * cof;\r\n            });\r\n        }\r\n\r\n        this.#clients.sort((a, b) => {\r\n            return a.score > b.score ? -1 : 1;\r\n        });\r\n\r\n        const elems = survivors * this.#clients.length;\r\n        for (let i = this.#clients.length - 1; i > elems; i -= 1) {\r\n            if (this.#clients[i].bestScore) {\r\n                continue;\r\n            }\r\n            this.#clients[i].species = null;\r\n            this.#clients.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    breed(): Genome {\r\n        const c1 = this.#getRandomClient();\r\n        const c2 = this.#getRandomClient();\r\n        if (c1.score >= c2.score) {\r\n            return Genome.crossOver(c1.genome, c2.genome);\r\n        } else {\r\n            return Genome.crossOver(c2.genome, c1.genome);\r\n        }\r\n    }\r\n\r\n    size(): number {\r\n        return this.#clients.length;\r\n    }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n"],"names":["root","factory","exports","module","define","amd","self","constructor","genome","nodes","connections","nodeHashmap","Map","i","data","length","n","ConnectionGene","node","Node","x","set","innovationNumber","this","push","sort","a","b","compereTo","c","NodeGene","from","to","nodeFrom","get","nodeTo","con","Connection","weight","enabled","calculate","input","Error","output","Array","value","sum","Math","exp","Set","contains","gene","randomElement","size","floor","random","add","addSorted","innovation","splice","clear","index","remove","arg","indexOf","delete","survivors","object","score","randomScore","scoreIndex","reset","Gene","super","replaceIndex","getHashKey","equals","obj","hashCode","Neat","MAX_NODES","neat","RandomHashSet","distance","g2","g1","higGene1","higGene2","tempG","indexG1","indexG2","disjoint","weightDiff","similar","gene1","gene2","inn1","inn2","abs","excess","N","max","CT","C1","C2","C3","static","emptyGenome","addedCon","getConnection","optimization","conn","mutateLink","geneA","geneB","temp","exists","forEach","item","WEIGHT_RANDOM_STRENGTH","mutateNode","getReplaceIndex","middle","getNode","y","setReplaceIndex","con1","con2","exists1","exists2","mutateWeightShift","newWeight","WEIGHT_SHIFT_STRENGTH","mutateWeightRandom","mutateLinkToggle","mutate","prob","PROBABILITY_MUTATE_NODES","PROBABILITY_MUTATE_LINK","PROBABILITY_MUTATE_TOGGLE_LINK","PROBABILITY_MUTATE_WEIGHT_RANDOM","PROBABILITY_MUTATE_WEIGHT_SHIFT","bestScore","species","generateCalculator","Calculator","client","inputNodes","outputNodes","clients","pow","allConnections","allNodes","CP","nodeGene","Client","node1","node2","hashKey","foundCon","Genome","connectionGene","has","id","evolve","printSpecies","console","log","selector","RandomSelector","s","breed","put","goExtinct","complexity","allCons","kill","found","k","Species","evaluateScore","force","cof","sqrt","elems","c1","c2","crossOver","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}