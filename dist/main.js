!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NeatJS=t():e.NeatJS=t()}(self,(()=>(()=>{"use strict";var e={266:function(e,t,n){var i,o,s,r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Calculator=void 0;const a=n(329),h=n(415),c=n(786);t.Calculator=class{constructor(e){i.set(this,[]),o.set(this,[]),s.set(this,[]);const t=e.nodes,n=e.connections,f=new Map;for(let e=0;e<t.data.length;e+=1){const n=t.data[e];if(n instanceof a.ConnectionGene)continue;const c=new h.Node(n.x);f.set(n.innovationNumber,c),n.x<=.1?r(this,i,"f").push(c):n.x>=.9?r(this,s,"f").push(c):r(this,o,"f").push(c)}r(this,o,"f").sort(((e,t)=>e.compereTo(t)));for(let e=0;e<n.data.length;e+=1){const t=n.data[e];if(t instanceof a.NodeGene)continue;const i=t.from,o=t.to,s=f.get(i.innovationNumber),r=f.get(o.innovationNumber);if(!s||!r)continue;const h=new c.Connection(s,r);h.weight=t.weight,h.enabled=t.enabled,r.connections.push(h)}}calculate(e){if(e.length!==r(this,i,"f").length)throw new Error("Data dosent fit");for(let t=0;t<r(this,i,"f").length;t++)r(this,i,"f")[t].output=e[t];for(let e=0;e<r(this,o,"f").length;e++)r(this,o,"f")[e].calculate();const t=new Array(r(this,s,"f").length);for(let e=0;e<r(this,s,"f").length;e++)r(this,s,"f")[e].calculate(),t[e]=r(this,s,"f")[e].output;return t}},i=new WeakMap,o=new WeakMap,s=new WeakMap},786:function(e,t){var n,i,o,s,r=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0,t.Connection=class{constructor(e,t){n.set(this,void 0),i.set(this,void 0),o.set(this,0),s.set(this,!0),r(this,n,e,"f"),r(this,i,t,"f")}get from(){return a(this,n,"f")}set from(e){r(this,n,e,"f")}get to(){return a(this,i,"f")}set to(e){r(this,i,e,"f")}get weight(){return a(this,o,"f")}set weight(e){r(this,o,e,"f")}get enabled(){return a(this,s,"f")}set enabled(e){r(this,s,e,"f")}},n=new WeakMap,i=new WeakMap,o=new WeakMap,s=new WeakMap},415:function(e,t){var n,i,o,s,r,a=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0,t.Node=class{constructor(e){n.add(this),i.set(this,void 0),o.set(this,0),s.set(this,[]),a(this,i,e,"f")}get x(){return h(this,i,"f")}set x(e){a(this,i,e,"f")}get output(){return h(this,o,"f")}set output(e){a(this,o,e,"f")}get connections(){return h(this,s,"f")}set connections(e){a(this,s,e,"f")}calculate(){let e=0;for(let t=0;t<h(this,s,"f").length;t+=1){const n=h(this,s,"f")[t];n.enabled&&(e+=n.weight*n.from.output)}a(this,o,h(this,n,"m",r).call(this,e),"f")}compereTo(e){return this.x>e.x?1:this.x<e.x?-1:0}},i=new WeakMap,o=new WeakMap,s=new WeakMap,n=new WeakSet,r=function(e){return 1/(1+Math.exp(-e))}},99:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(415),t),o(n(786),t),o(n(266),t)},884:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(557),t),o(n(646),t)},557:function(e,t,n){var i,o,s=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.RandomHashSet=void 0;const a=n(329);t.RandomHashSet=class{constructor(){i.set(this,void 0),o.set(this,void 0),s(this,i,new Set,"f"),s(this,o,[],"f")}contains(e){let t=!1;for(let n=0;n<this.data.length;n+=1)this.data[n].innovationNumber===e.innovationNumber&&(t=!0);return t}randomElement(){return r(this,i,"f").size?r(this,o,"f")[Math.floor(r(this,o,"f").length*Math.random())]:null}add(e){this.contains(e)||(r(this,i,"f").add(e),r(this,o,"f").push(e))}addSorted(e){if(!this.contains(e)){for(let t=0;t<this.size();t++){const n=this.get(t).innovationNumber;if(e.innovationNumber<n)return r(this,o,"f").splice(t,0,e),void r(this,i,"f").add(e)}r(this,i,"f").add(e),r(this,o,"f").push(e)}}size(){return r(this,o,"f").length}clear(){r(this,i,"f").clear(),s(this,o,[],"f")}get(e){return r(this,o,"f")[e]}remove(e){if(e instanceof a.ConnectionGene){const t=r(this,o,"f").indexOf(e);r(this,o,"f").splice(t,1),r(this,i,"f").delete(e)}else{if(e<0||e>=r(this,i,"f").size)return;r(this,i,"f").delete(r(this,o,"f")[e]),r(this,o,"f").splice(e,1)}}get data(){return r(this,o,"f")}},i=new WeakMap,o=new WeakMap},646:function(e,t){var n,i,o,s=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSelector=void 0,t.RandomSelector=class{constructor(e){n.set(this,[]),i.set(this,void 0),o.set(this,0),s(this,i,e,"f")}add(e){r(this,n,"f").push(e),s(this,o,r(this,o,"f")+e.score,"f"),r(this,n,"f").sort(((e,t)=>e.score>t.score?-1:1))}random(){const e=Math.random()*r(this,o,"f")*r(this,i,"f");let t=0;for(let i=0;i<r(this,n,"f").length;i++)if(t+=r(this,n,"f")[i].score,t>=e)return r(this,n,"f")[i];throw new Error("random Species not found")}reset(){s(this,n,[],"f"),s(this,o,0,"f")}},n=new WeakMap,i=new WeakMap,o=new WeakMap},271:function(e,t,n){var i,o,s,r,a,h=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionGene=void 0;const f=n(430),l=n(983);class u extends f.Gene{constructor(e,t,n){super(e),i.set(this,void 0),o.set(this,void 0),s.set(this,0),r.set(this,!0),a.set(this,0),h(this,i,t,"f"),h(this,o,n,"f")}get replaceIndex(){return c(this,a,"f")}set replaceIndex(e){h(this,a,e,"f")}get from(){return c(this,i,"f")}set from(e){h(this,i,e,"f")}get to(){return c(this,o,"f")}set to(e){h(this,o,e,"f")}get weight(){return c(this,s,"f")}set weight(e){h(this,s,e,"f")}get enabled(){return c(this,r,"f")}set enabled(e){h(this,r,e,"f")}getHashKey(){return`${this.from.innovationNumber}-${this.from.x}-${this.to.innovationNumber}-${this.to.x}`}equals(e){return e instanceof u&&this.from.equals(e.from)&&this.to.equals(e.to)}hashCode(){return this.from.innovationNumber*l.Neat.MAX_NODES+this.to.innovationNumber}}t.ConnectionGene=u,i=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap},430:function(e,t){var n,i=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Gene=void 0,t.Gene=class{constructor(e){n.set(this,void 0),i(this,n,e,"f")}get innovationNumber(){return o(this,n,"f")}set innovationNumber(e){i(this,n,e,"f")}},n=new WeakMap},303:function(e,t,n){var i,o,s,r=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Genome=void 0;const h=n(884),c=n(983),f=n(271),l=n(550);t.Genome=class{constructor(e){i.set(this,new h.RandomHashSet),o.set(this,new h.RandomHashSet),s.set(this,void 0),r(this,s,e,"f")}get connections(){return a(this,i,"f")}get nodes(){return a(this,o,"f")}get neat(){return a(this,s,"f")}distance(e){let t=this;const n=t.connections.get(t.connections.size()-1),i=e.connections.get(e.connections.size()-1);if((n instanceof f.ConnectionGene?n.innovationNumber:0)<(i instanceof f.ConnectionGene?i.innovationNumber:0)){const n=t;t=e,e=n}let o=0,r=0,h=0,c=0,l=0;for(;o<t.connections.size()&&r<e.connections.size();){const n=t.connections.get(o),i=e.connections.get(r);if(!(n instanceof f.ConnectionGene&&i instanceof f.ConnectionGene))throw new Error("gene is not a ConnectionGene");const s=n.innovationNumber,a=i.innovationNumber;s>a?(r++,h++):s<a?(o++,h++):(o++,r++,l++,c+=Math.abs(n.weight-i.weight))}c/=l||1;const u=t.connections.size()-o;let d=Math.max(t.connections.size(),e.connections.size());return d=d<a(this,s,"f").CT?1:d,a(this,s,"f").C1*u/d+a(this,s,"f").C2*h/d+a(this,s,"f").C3*c}static crossOver(e,t){const n=e.neat.emptyGenome();let i=0,o=0;for(;i<e.connections.size()&&o<t.connections.size();){const s=e.connections.get(i),r=t.connections.get(o);if(!(s instanceof f.ConnectionGene&&r instanceof f.ConnectionGene))throw new Error("gene is not a ConnectionGene");const a=s.innovationNumber,h=r.innovationNumber;let l=null;a>h?o++:a<h?(l=c.Neat.getConnection(s),i++):((s.enabled||r.enabled)&&(l=Math.random()>.4?c.Neat.getConnection(s):c.Neat.getConnection(r)),i++,o++),l instanceof f.ConnectionGene&&(!e.neat.optimization||Math.random()<.99||e.nodes.size()<e.neat.CT)&&n.connections.addSorted(l)}for(;i<e.connections.size();){const t=e.connections.get(i);if(!(t instanceof f.ConnectionGene))throw new Error("gene is not a ConnectionGene");(!e.neat.optimization||Math.random()<.99||e.nodes.size()<e.neat.CT)&&n.connections.addSorted(c.Neat.getConnection(t)),i++}for(let e=0;e<n.connections.data.length;e++){const t=n.connections.get(e);if(!(t instanceof f.ConnectionGene))throw new Error("gene is not a ConnectionGene");n.nodes.add(t.from),n.nodes.add(t.to)}return n}mutateLink(){let e=a(this,o,"f").randomElement(),t=a(this,o,"f").randomElement();if(!(e instanceof l.NodeGene&&t instanceof l.NodeGene))return null;for(;t instanceof l.NodeGene&&e.x===t.x;)t=a(this,o,"f").randomElement();if(!(t instanceof l.NodeGene))return null;if(e.x>t.x){const n=e;e=t,t=n}let n=!1;if(a(this,i,"f").data.forEach((i=>{i instanceof l.NodeGene||i.from===e&&i.to===t&&(n=!0)})),n)return null;const r=a(this,s,"f").getConnection(e,t);return r.weight=(2*Math.random()-1)*a(this,s,"f").WEIGHT_RANDOM_STRENGTH,a(this,i,"f").addSorted(r),r}mutateNode(){const e=a(this,i,"f").randomElement();if(!(e instanceof f.ConnectionGene))return null;const t=e.from,n=e.to,r=a(this,s,"f").getReplaceIndex(t,n);let h;0===r?(h=a(this,s,"f").getNode(),h.x=(t.x+n.x)/2,h.y=(t.y+n.y)/2+.6*Math.random()-.3,h.y=h.y<.1?.1:h.y>.9?.9:h.y,a(this,s,"f").setReplaceIndex(t,n,h.innovationNumber)):h=a(this,s,"f").getNode(r);const c=a(this,s,"f").getConnection(t,h),u=a(this,s,"f").getConnection(h,n);let d=!1,w=!1;return a(this,i,"f").data.forEach((e=>{e instanceof l.NodeGene||(e.from===t&&e.to===h&&(d=!0),e.from===h&&e.to===n&&(w=!0))})),d||(c.weight=1,u.weight=e.weight,a(this,i,"f").addSorted(c)),w||(u.enabled=e.enabled,a(this,i,"f").addSorted(u)),d&&w||(e.enabled=!1),a(this,o,"f").add(h),h}mutateWeightShift(){const e=a(this,i,"f").randomElement();if(!(e instanceof f.ConnectionGene))return null;let t=e.weight;for(;t===e.weight;)t=e.weight+(2*Math.random()-1)*a(this,s,"f").WEIGHT_SHIFT_STRENGTH;return e.weight=t,e}mutateWeightRandom(){const e=a(this,i,"f").randomElement();if(!(e instanceof f.ConnectionGene))return null;let t=e.weight||a(this,s,"f").WEIGHT_RANDOM_STRENGTH;for(;t===e.weight;)t=(Math.random()*t*2-t)*a(this,s,"f").WEIGHT_RANDOM_STRENGTH;return e.weight=t,e}mutateLinkToggle(){const e=a(this,i,"f").randomElement();return e instanceof f.ConnectionGene?(e.enabled=!e.enabled,e):null}mutate(){let e;for(e=a(this,s,"f").PROBABILITY_MUTATE_NODES,e=e>a(this,i,"f").size()?a(this,i,"f").size():e;e>Math.random();)e--,this.mutateNode();for(e=a(this,s,"f").PROBABILITY_MUTATE_LINK,e=e<a(this,s,"f").CT?a(this,s,"f").CT:e;e>Math.random();)e--,this.mutateLink();for(e=a(this,s,"f").PROBABILITY_MUTATE_TOGGLE_LINK,e=e>a(this,i,"f").size()?a(this,i,"f").size():e;e>Math.random();)e--,this.mutateLinkToggle();for(e=a(this,s,"f").PROBABILITY_MUTATE_WEIGHT_RANDOM,e=e>a(this,i,"f").size()?a(this,i,"f").size():e;e>Math.random();)e--,this.mutateWeightRandom();for(e=a(this,s,"f").PROBABILITY_MUTATE_WEIGHT_SHIFT,e=e>a(this,i,"f").size()?a(this,i,"f").size():e;e>Math.random();)e--,this.mutateWeightShift()}},i=new WeakMap,o=new WeakMap,s=new WeakMap},329:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(430),t),o(n(550),t),o(n(271),t),o(n(303),t)},550:function(e,t,n){var i,o,s=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},r=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeGene=void 0;const a=n(430);class h extends a.Gene{constructor(e){super(e),i.set(this,0),o.set(this,0)}get x(){return s(this,i,"f")}set x(e){r(this,i,e,"f")}get y(){return s(this,o,"f")}set y(e){r(this,o,e,"f")}equals(e){return e instanceof h&&this.innovationNumber===e.innovationNumber}hashCode(){return this.innovationNumber}}t.NodeGene=h,i=new WeakMap,o=new WeakMap},607:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(983),t)},716:function(e,t,n){var i,o,s,r,a,h=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const f=n(99);t.Client=class{constructor(e){i.set(this,void 0),o.set(this,0),s.set(this,!1),r.set(this,void 0),a.set(this,void 0),h(this,i,e,"f"),h(this,a,null,"f"),h(this,r,null,"f")}get bestScore(){return c(this,s,"f")}set bestScore(e){h(this,s,e,"f")}get genome(){return c(this,i,"f")}set genome(e){h(this,i,e,"f")}get score(){return c(this,o,"f")}set score(e){h(this,o,e,"f")}get species(){return c(this,r,"f")}set species(e){h(this,r,e,"f")}generateCalculator(){h(this,a,new f.Calculator(c(this,i,"f")),"f")}distance(e){return this.genome.distance(e.genome)}mutate(){this.bestScore||this.genome.mutate()}calculate(e){var t;return c(this,a,"f")||this.generateCalculator(),(null===(t=c(this,a,"f"))||void 0===t?void 0:t.calculate(e))||[]}},i=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap},983:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(560),t),o(n(765),t),o(n(716),t)},560:function(e,t,n){var i,o,s,r,a,h,c,f,l,u,d,w,p,m,v,g,b,_,y,T,M,E,P,C,G,N,W,O,k,S=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},j=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.Neat=void 0;const x=n(329),I=n(884),z=n(716),R=n(765);t.Neat=class{constructor(e,t,n){i.add(this),o.set(this,1),s.set(this,1),r.set(this,.1),a.set(this,10),h.set(this,1),c.set(this,5),f.set(this,10),l.set(this,.8),u.set(this,4),d.set(this,.5),w.set(this,.2),p.set(this,.05),m.set(this,.05),v.set(this,0),g.set(this,0),b.set(this,0),_.set(this,0),y.set(this,[]),T.set(this,[]),M.set(this,new Map),E.set(this,new I.RandomHashSet),P.set(this,!1),this.reset(e,t,n)}static get MAX_NODES(){return Math.pow(2,20)}get optimization(){return S(this,P,"f")}set optimization(e){j(this,P,e,"f")}get clients(){return S(this,y,"f")}get allConnections(){return S(this,M,"f")}get allNodes(){return S(this,E,"f")}get WEIGHT_SHIFT_STRENGTH(){return S(this,c,"f")}get WEIGHT_RANDOM_STRENGTH(){return S(this,f,"f")}get PROBABILITY_MUTATE_LINK(){return S(this,p,"f")}get PROBABILITY_MUTATE_NODES(){return S(this,m,"f")}get PROBABILITY_MUTATE_WEIGHT_SHIFT(){return S(this,u,"f")}get PROBABILITY_MUTATE_WEIGHT_RANDOM(){return S(this,w,"f")}get PROBABILITY_MUTATE_TOGGLE_LINK(){return S(this,d,"f")}set CT(e){j(this,h,e,"f")}get CT(){return S(this,h,"f")}get CP(){return S(this,a,"f")}get C1(){return S(this,o,"f")}get C2(){return S(this,s,"f")}get C3(){return S(this,r,"f")}reset(e,t,n){j(this,v,e,"f"),j(this,g,t,"f"),j(this,b,n,"f"),S(this,M,"f").clear(),S(this,E,"f").clear(),j(this,y,[],"f"),this.CT=3*(e+t);for(let e=0;e<S(this,v,"f");e+=1){const t=this.getNode();t.x=.1,t.y=(e+1)/(S(this,v,"f")+1)}for(let e=0;e<S(this,g,"f");e+=1){const t=this.getNode();t.x=.9,t.y=(e+1)/(S(this,g,"f")+1)}for(let e=0;e<S(this,b,"f");e+=1){const e=new z.Client(this.emptyGenome());e.generateCalculator(),S(this,y,"f").push(e)}}setReplaceIndex(e,t,n){const i=new x.ConnectionGene(0,e,t).getHashKey(),o=S(this,M,"f").get(i);if(!o)throw new Error("setReplaceIndex to no connection");o.replaceIndex=n}getReplaceIndex(e,t){const n=new x.ConnectionGene(0,e,t).getHashKey(),i=S(this,M,"f").get(n);return i?i.replaceIndex:0}emptyGenome(){const e=new x.Genome(this);for(let t=0;t<S(this,v,"f")+S(this,g,"f");t+=1)e.nodes.add(this.getNode(t+1));return e}static getConnection(e){const t=new x.ConnectionGene(e.innovationNumber,e.from,e.to);return t.weight=e.weight,t.enabled=e.enabled,t}getConnection(e,t){const n=new x.ConnectionGene(0,e,t),i=n.getHashKey();if(S(this,M,"f").has(i)){const e=S(this,M,"f").get(i);n.innovationNumber=e?e.innovationNumber:0}else S(this,M,"f").set(i,n),n.innovationNumber=S(this,M,"f").size+1;return n}getNode(e){let t;if(e&&e<=S(this,E,"f").size()){if(t=S(this,E,"f").get(e-1),!(t instanceof x.NodeGene))throw new Error("getNode returns not a NodeGene")}else t=new x.NodeGene(S(this,E,"f").size()+1),S(this,E,"f").add(t);return t}evolve(){var e;j(this,_,(e=S(this,_,"f"),++e),"f"),S(this,_,"f")%50==0&&j(this,P,!0,"f"),S(this,i,"m",k).call(this),S(this,i,"m",O).call(this),S(this,i,"m",W).call(this),S(this,i,"m",N).call(this),S(this,i,"m",G).call(this),S(this,i,"m",C).call(this);for(let e=0;e<S(this,y,"f").length;e+=1)S(this,y,"f")[e].generateCalculator()}printSpecies(){for(let e=0;e<S(this,T,"f").length;e+=1)console.log(S(this,T,"f")[e].score,S(this,T,"f")[e].size())}},o=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap,h=new WeakMap,c=new WeakMap,f=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,w=new WeakMap,p=new WeakMap,m=new WeakMap,v=new WeakMap,g=new WeakMap,b=new WeakMap,_=new WeakMap,y=new WeakMap,T=new WeakMap,M=new WeakMap,E=new WeakMap,P=new WeakMap,i=new WeakSet,C=function(){for(let e=0;e<S(this,y,"f").length;e+=1)S(this,y,"f")[e].mutate()},G=function(){const e=new I.RandomSelector(S(this,l,"f"));for(let t=0;t<S(this,T,"f").length;t+=1)e.add(S(this,T,"f")[t]);for(let t=0;t<S(this,y,"f").length;t+=1){const n=S(this,y,"f")[t];if(null===n.species){const t=e.random();n.genome=t.breed(),t.put(n,!0)}}},N=function(){for(let e=S(this,T,"f").length-1;e>=0;e--)S(this,T,"f")[e].size()<=1&&!S(this,T,"f")[e].clients[0].bestScore&&(S(this,T,"f")[e].goExtinct(),S(this,T,"f").splice(e,1))},W=function(){let e=0;S(this,y,"f").forEach((t=>{const n=t.genome.nodes.size()+t.genome.connections.size();e=e<n?n:e}));for(let t=0;t<S(this,T,"f").length;t+=1)S(this,T,"f")[t].kill(S(this,l,"f"),e)},O=function(){for(let e=0;e<S(this,T,"f").length;e+=1)S(this,T,"f")[e].reset(this.optimization);for(let e=0;e<S(this,y,"f").length;e+=1){const t=S(this,y,"f")[e];if(null!==t.species)continue;let n=!1;for(let e=0;e<S(this,T,"f").length;e+=1)if(S(this,T,"f")[e].put(t)){n=!0;break}n||S(this,T,"f").push(new R.Species(t))}for(let e=0;e<S(this,T,"f").length;e+=1)S(this,T,"f")[e].evaluateScore()},k=function(){let e=0;for(let t=0;t<S(this,y,"f").length;t+=1)S(this,y,"f")[t].bestScore=!1,e=S(this,y,"f")[t].score>e?S(this,y,"f")[t].score:e;for(let t=0;t<S(this,y,"f").length;t+=1)if(S(this,y,"f")[t].score===e)return void(S(this,y,"f")[t].bestScore=!0)}},765:function(e,t,n){var i,o,s,r,a,h,c=this&&this.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Species=void 0;const l=n(329);t.Species=class{constructor(e){i.add(this),o.set(this,[]),s.set(this,void 0),r.set(this,0),a.set(this,!1),c(this,s,e,"f"),f(this,s,"f").species=this,f(this,o,"f").push(e)}get score(){return f(this,r,"f")}get clients(){return f(this,o,"f")}put(e,t=!1){return!!(t||e.distance(f(this,s,"f"))<f(this,s,"f").genome.neat.CP)&&(e.species=this,f(this,o,"f").push(e),!0)}goExtinct(){for(let e=0;e<f(this,o,"f").length;e+=1)f(this,o,"f")[e].species=null}evaluateScore(){let e=0;for(let t=0;t<f(this,o,"f").length;t+=1)e+=f(this,o,"f")[t].score;c(this,r,e/f(this,o,"f").length,"f")}reset(e){c(this,a,e,"f"),c(this,s,f(this,i,"m",h).call(this),"f"),this.goExtinct(),c(this,o,[],"f"),f(this,o,"f").push(f(this,s,"f")),f(this,s,"f").species=this,c(this,r,0,"f")}kill(e=.5,t){const n=f(this,a,"f")?1:.5;t&&f(this,o,"f").forEach((e=>{const i=e.genome.nodes.size()+e.genome.connections.size();e.score+=Math.sqrt(t-i)/t*n})),f(this,o,"f").sort(((e,t)=>e.score>t.score?-1:1));const i=e*f(this,o,"f").length;for(let e=f(this,o,"f").length-1;e>i;e-=1)f(this,o,"f")[e].bestScore||(f(this,o,"f")[e].species=null,f(this,o,"f").splice(e,1))}breed(){const e=f(this,i,"m",h).call(this),t=f(this,i,"m",h).call(this);return e.score>=t.score?l.Genome.crossOver(e.genome,t.genome):l.Genome.crossOver(t.genome,e.genome)}size(){return f(this,o,"f").length}},o=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap,i=new WeakSet,h=function(){return f(this,o,"f")[Math.floor(Math.random()*f(this,o,"f").length)]}}},t={};return function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}(607)})()));
//# sourceMappingURL=main.js.map