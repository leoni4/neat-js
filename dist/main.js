!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NeatJS=t():e.NeatJS=t()}(self,(()=>(()=>{"use strict";var e={266:function(e,t,n){var i,s,o,r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Calculator=void 0;const a=n(329),h=n(415),c=n(786);t.Calculator=class{constructor(e){i.set(this,[]),s.set(this,[]),o.set(this,[]);const t=e.nodes,n=e.connections,f=new Map;for(let e=0;e<t.data.length;e+=1){const n=t.data[e];if(n instanceof a.ConnectionGene)continue;const c=new h.Node(n.x);f.set(n.innovationNumber,c),n.x<=.1?r(this,i,"f").push(c):n.x>=.9?r(this,o,"f").push(c):r(this,s,"f").push(c)}r(this,s,"f").sort(((e,t)=>e.compereTo(t)));for(let e=0;e<n.data.length;e+=1){const t=n.data[e];if(t instanceof a.NodeGene)continue;const i=t.from,s=t.to,o=f.get(i.innovationNumber),r=f.get(s.innovationNumber);if(!o||!r)continue;const h=new c.Connection(o,r);h.weight=t.weight,h.enabled=t.enabled,r.connections.push(h)}}calculate(e){if(e.length!==r(this,i,"f").length)throw new Error("Data dosent fit");for(let t=0;t<r(this,i,"f").length;t++)r(this,i,"f")[t].output=e[t];for(let e=0;e<r(this,s,"f").length;e++)r(this,s,"f")[e].calculate();const t=new Array(r(this,o,"f").length);for(let e=0;e<r(this,o,"f").length;e++)r(this,o,"f")[e].calculate(),t[e]=r(this,o,"f")[e].output;return t}},i=new WeakMap,s=new WeakMap,o=new WeakMap},786:function(e,t){var n,i,s,o,r=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0,t.Connection=class{constructor(e,t){n.set(this,void 0),i.set(this,void 0),s.set(this,0),o.set(this,!0),r(this,n,e,"f"),r(this,i,t,"f")}get from(){return a(this,n,"f")}set from(e){r(this,n,e,"f")}get to(){return a(this,i,"f")}set to(e){r(this,i,e,"f")}get weight(){return a(this,s,"f")}set weight(e){r(this,s,e,"f")}get enabled(){return a(this,o,"f")}set enabled(e){r(this,o,e,"f")}},n=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap},415:function(e,t){var n,i,s,o,r,a=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0,t.Node=class{constructor(e){n.add(this),i.set(this,void 0),s.set(this,0),o.set(this,[]),a(this,i,e,"f")}get x(){return h(this,i,"f")}set x(e){a(this,i,e,"f")}get output(){return h(this,s,"f")}set output(e){a(this,s,e,"f")}get connections(){return h(this,o,"f")}set connections(e){a(this,o,e,"f")}calculate(){let e=0;for(let t=0;t<h(this,o,"f").length;t+=1){const n=h(this,o,"f")[t];n.enabled&&(e+=n.weight*n.from.output)}a(this,s,h(this,n,"m",r).call(this,e),"f")}compereTo(e){return this.x>e.x?1:this.x<e.x?-1:0}},i=new WeakMap,s=new WeakMap,o=new WeakMap,n=new WeakSet,r=function(e){return 1/(1+Math.exp(-e))}},99:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(415),t),s(n(786),t),s(n(266),t)},884:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(557),t),s(n(646),t)},557:function(e,t,n){var i,s,o=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.RandomHashSet=void 0;const a=n(329);t.RandomHashSet=class{constructor(){i.set(this,void 0),s.set(this,void 0),o(this,i,new Set,"f"),o(this,s,[],"f")}contains(e){let t=!1;for(let n=0;n<this.data.length;n+=1)this.data[n].innovationNumber===e.innovationNumber&&(t=!0);return t}randomElement(){return r(this,i,"f").size?r(this,s,"f")[Math.floor(r(this,s,"f").length*Math.random())]:null}add(e){this.contains(e)||(r(this,i,"f").add(e),r(this,s,"f").push(e))}addSorted(e){if(!this.contains(e)){for(let t=0;t<this.size();t++){const n=this.get(t).innovationNumber;if(e.innovationNumber<n)return r(this,s,"f").splice(t,0,e),void r(this,i,"f").add(e)}r(this,i,"f").add(e),r(this,s,"f").push(e)}}size(){return r(this,s,"f").length}clear(){r(this,i,"f").clear(),o(this,s,[],"f")}get(e){return r(this,s,"f")[e]}remove(e){if(e instanceof a.ConnectionGene){const t=r(this,s,"f").indexOf(e);r(this,s,"f").splice(t,1),r(this,i,"f").delete(e)}else{if(e<0||e>=r(this,i,"f").size)return;r(this,i,"f").delete(r(this,s,"f")[e]),r(this,s,"f").splice(e,1)}}get data(){return r(this,s,"f")}},i=new WeakMap,s=new WeakMap},646:function(e,t){var n,i,s,o=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSelector=void 0,t.RandomSelector=class{constructor(e){n.set(this,[]),i.set(this,void 0),s.set(this,0),o(this,i,e,"f")}add(e){r(this,n,"f").push(e),o(this,s,r(this,s,"f")+e.score,"f"),r(this,n,"f").sort(((e,t)=>e.score>t.score?-1:1))}random(){const e=Math.abs(Math.random()*r(this,s,"f")*r(this,i,"f"));let t=0;for(let i=0;i<r(this,n,"f").length;i++)if(t+=Math.abs(r(this,n,"f")[i].score),t>=e)return r(this,n,"f")[i];throw new Error("random Species not found")}reset(){o(this,n,[],"f"),o(this,s,0,"f")}},n=new WeakMap,i=new WeakMap,s=new WeakMap},271:function(e,t,n){var i,s,o,r,a,h=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionGene=void 0;const f=n(430),l=n(983);class u extends f.Gene{constructor(e,t,n){super(e),i.set(this,void 0),s.set(this,void 0),o.set(this,0),r.set(this,!0),a.set(this,0),h(this,i,t,"f"),h(this,s,n,"f")}get replaceIndex(){return c(this,a,"f")}set replaceIndex(e){h(this,a,e,"f")}get from(){return c(this,i,"f")}set from(e){h(this,i,e,"f")}get to(){return c(this,s,"f")}set to(e){h(this,s,e,"f")}get weight(){return c(this,o,"f")}set weight(e){h(this,o,e,"f")}get enabled(){return c(this,r,"f")}set enabled(e){h(this,r,e,"f")}getHashKey(){return`${this.from.innovationNumber}-${this.from.x}-${this.to.innovationNumber}-${this.to.x}`}equals(e){return e instanceof u&&this.from.equals(e.from)&&this.to.equals(e.to)}hashCode(){return this.from.innovationNumber*l.Neat.MAX_NODES+this.to.innovationNumber}}t.ConnectionGene=u,i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap},430:function(e,t){var n,i=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},s=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Gene=void 0,t.Gene=class{constructor(e){n.set(this,void 0),i(this,n,e,"f")}get innovationNumber(){return s(this,n,"f")}set innovationNumber(e){i(this,n,e,"f")}},n=new WeakMap},303:function(e,t,n){var i,s,o,r,a,h,c,f=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Genome=void 0;const u=n(884),d=n(983),w=n(271),p=n(550);t.Genome=class{constructor(e){i.add(this),s.set(this,new u.RandomHashSet),o.set(this,new u.RandomHashSet),r.set(this,void 0),a.set(this,void 0),h.set(this,!1),f(this,r,e,"f"),f(this,a,e.OPT_ERR_TRASHHOLD,"f")}get selfOpt(){return l(this,h,"f")}get optErrTrashhold(){return l(this,a,"f")}get connections(){return l(this,s,"f")}get nodes(){return l(this,o,"f")}get neat(){return l(this,r,"f")}distance(e){let t=this;const n=t.connections.get(t.connections.size()-1),i=e.connections.get(e.connections.size()-1);if((n instanceof w.ConnectionGene?n.innovationNumber:0)<(i instanceof w.ConnectionGene?i.innovationNumber:0)){const n=t;t=e,e=n}let s=0,o=0,a=0,h=0,c=0;for(;s<t.connections.size()&&o<e.connections.size();){const n=t.connections.get(s),i=e.connections.get(o);if(!(n instanceof w.ConnectionGene&&i instanceof w.ConnectionGene))throw new Error("gene is not a ConnectionGene");const r=n.innovationNumber,f=i.innovationNumber;r>f?(o++,a++):r<f?(s++,a++):(s++,o++,c++,h+=Math.abs(n.weight-i.weight))}h/=c||1;const f=t.connections.size()-s;let u=Math.max(t.connections.size(),e.connections.size());return u=u<l(this,r,"f").CT?1:u,l(this,r,"f").C1*f/u+l(this,r,"f").C2*a/u+l(this,r,"f").C3*h}static crossOver(e,t){const n=e.neat.emptyGenome();let i=0,s=0;for(;i<e.connections.size()&&s<t.connections.size();){const o=e.connections.get(i),r=t.connections.get(s);if(!(o instanceof w.ConnectionGene&&r instanceof w.ConnectionGene))throw new Error("gene is not a ConnectionGene");const a=o.innovationNumber,h=r.innovationNumber;let c=null;a>h?s++:a<h?(e.selfOpt&&n.neat.optimization&&!o.enabled||(c=d.Neat.getConnection(o)),i++):((!e.selfOpt&&!t.selfOpt||!n.neat.optimization||o.enabled&&r.enabled)&&(c=Math.random()>.4?d.Neat.getConnection(o):d.Neat.getConnection(r)),i++,s++),c instanceof w.ConnectionGene&&n.connections.addSorted(c)}for(;i<e.connections.size();){const t=e.connections.get(i);if(!(t instanceof w.ConnectionGene))throw new Error("gene is not a ConnectionGene");e.neat.optimization&&!t.enabled||n.connections.addSorted(d.Neat.getConnection(t)),i++}for(let e=0;e<n.connections.data.length;e++){const t=n.connections.get(e);if(!(t instanceof w.ConnectionGene))throw new Error("gene is not a ConnectionGene");n.nodes.add(t.from),n.nodes.add(t.to)}return n}mutateLink(){let e=l(this,o,"f").randomElement(),t=l(this,o,"f").randomElement();if(!(e instanceof p.NodeGene&&t instanceof p.NodeGene))return null;for(;t instanceof p.NodeGene&&e.x===t.x;)t=l(this,o,"f").randomElement();if(!(t instanceof p.NodeGene))return null;if(e.x>t.x){const n=e;e=t,t=n}let n=!1;if(l(this,s,"f").data.forEach((i=>{i instanceof p.NodeGene||i.from===e&&i.to===t&&(n=!0)})),n)return null;const i=l(this,r,"f").getConnection(e,t);return i.weight=(2*Math.random()-1)*l(this,r,"f").WEIGHT_RANDOM_STRENGTH,l(this,s,"f").addSorted(i),i}mutateNode(){const e=l(this,s,"f").randomElement();if(!(e instanceof w.ConnectionGene))return null;const t=e.from,n=e.to,i=l(this,r,"f").getReplaceIndex(t,n);let a;0===i?(a=l(this,r,"f").getNode(),a.x=(t.x+n.x)/2,a.y=(t.y+n.y)/2+.6*Math.random()-.3,a.y=a.y<.1?.1:a.y>.9?.9:a.y,l(this,r,"f").setReplaceIndex(t,n,a.innovationNumber)):a=l(this,r,"f").getNode(i);const h=l(this,r,"f").getConnection(t,a),c=l(this,r,"f").getConnection(a,n);let f=!1,u=!1;return l(this,s,"f").data.forEach((e=>{e instanceof p.NodeGene||(e.from===t&&e.to===a&&(f=!0),e.from===a&&e.to===n&&(u=!0))})),f||(h.weight=1,c.weight=e.weight,l(this,s,"f").addSorted(h)),u||(c.enabled=e.enabled,l(this,s,"f").addSorted(c)),f&&u||(e.enabled=!1),l(this,o,"f").add(a),a}mutateWeightShift(){const e=l(this,s,"f").randomElement();if(!(e instanceof w.ConnectionGene))return null;let t=e.weight;for(;t===e.weight;)t=e.weight+(2*Math.random()-1)*l(this,r,"f").WEIGHT_SHIFT_STRENGTH;return e.weight=t,e}mutateWeightRandom(){const e=l(this,s,"f").randomElement();if(!(e instanceof w.ConnectionGene))return null;let t=e.weight||l(this,r,"f").WEIGHT_RANDOM_STRENGTH;for(;t===e.weight;)t=(Math.random()*t*2-t)*l(this,r,"f").WEIGHT_RANDOM_STRENGTH;return e.weight=t,e}mutateLinkToggle(){const e=l(this,s,"f").randomElement();return e instanceof w.ConnectionGene?(l(this,h,"f")&&!e.enabled||(e.enabled=!e.enabled),e):null}mutate(e=!1){let t;if(f(this,h,e,"f"),(l(this,h,"f")||l(this,r,"f").optimization)&&l(this,i,"m",c).call(this),!e||!l(this,r,"f").optimization||l(this,s,"f").size()<l(this,r,"f").CT){for(t=l(this,r,"f").PROBABILITY_MUTATE_NODES,t=t>l(this,s,"f").size()?l(this,s,"f").size():t;t>Math.random();)t--,this.mutateNode();for(t=l(this,r,"f").PROBABILITY_MUTATE_LINK,t=t<l(this,r,"f").CT?l(this,r,"f").CT:t;t>Math.random();)t--,this.mutateLink()}for(t=l(this,r,"f").PROBABILITY_MUTATE_TOGGLE_LINK;t>Math.random();)t--,this.mutateLinkToggle();for(t=l(this,r,"f").PROBABILITY_MUTATE_WEIGHT_RANDOM,t=t>l(this,s,"f").size()?l(this,s,"f").size():t;t>Math.random();)t--,this.mutateWeightRandom();for(t=l(this,r,"f").PROBABILITY_MUTATE_WEIGHT_SHIFT,t=t>l(this,s,"f").size()?l(this,s,"f").size():t;t>Math.random();)t--,this.mutateWeightShift()}},s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,h=new WeakMap,i=new WeakSet,c=function(){let e=0;for(let t=0;t<l(this,s,"f").size();t+=1){const n=l(this,s,"f").get(t);n instanceof w.ConnectionGene&&(n.enabled?e=n.weight>e?n.weight:e:(l(this,s,"f").remove(t),t--))}}},329:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(430),t),s(n(550),t),s(n(271),t),s(n(303),t)},550:function(e,t,n){var i,s,o=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},r=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeGene=void 0;const a=n(430);class h extends a.Gene{constructor(e){super(e),i.set(this,0),s.set(this,0)}get x(){return o(this,i,"f")}set x(e){r(this,i,e,"f")}get y(){return o(this,s,"f")}set y(e){r(this,s,e,"f")}equals(e){return e instanceof h&&this.innovationNumber===e.innovationNumber}hashCode(){return this.innovationNumber}}t.NodeGene=h,i=new WeakMap,s=new WeakMap},716:function(e,t,n){var i,s,o,r,a,h,c=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const l=n(99);t.Client=class{constructor(e){i.set(this,void 0),s.set(this,0),o.set(this,0),r.set(this,!1),a.set(this,void 0),h.set(this,void 0),c(this,i,e,"f"),c(this,h,null,"f"),c(this,a,null,"f")}get bestScore(){return f(this,r,"f")}set bestScore(e){c(this,r,e,"f")}get genome(){return f(this,i,"f")}set genome(e){c(this,i,e,"f")}get error(){return f(this,o,"f")}set error(e){c(this,o,e,"f")}get score(){return f(this,s,"f")}set score(e){c(this,s,e,"f")}get species(){return f(this,a,"f")}set species(e){c(this,a,e,"f")}generateCalculator(){c(this,h,new l.Calculator(f(this,i,"f")),"f")}distance(e){return this.genome.distance(e.genome)}mutate(){this.bestScore||this.genome.mutate(this.error<this.genome.optErrTrashhold)}calculate(e){var t;return f(this,h,"f")||this.generateCalculator(),(null===(t=f(this,h,"f"))||void 0===t?void 0:t.calculate(e))||[]}},i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,h=new WeakMap},983:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(560),t),s(n(765),t),s(n(716),t)},560:function(e,t,n){var i,s,o,r,a,h,c,f,l,u,d,w,p,m,v,g,b,_,y,T,M,E,P,C,N,G,W,O,k,S,j=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},x=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.Neat=void 0;const I=n(329),R=n(884),z=n(716),H=n(765);t.Neat=class{constructor(e,t,n){i.add(this),s.set(this,1),o.set(this,1),r.set(this,.1),a.set(this,10),h.set(this,1),c.set(this,5),f.set(this,10),l.set(this,.8),u.set(this,4),d.set(this,.5),w.set(this,.2),p.set(this,.05),m.set(this,.05),v.set(this,.005),g.set(this,0),b.set(this,0),_.set(this,0),y.set(this,0),T.set(this,[]),M.set(this,[]),E.set(this,new Map),P.set(this,new R.RandomHashSet),C.set(this,!1),this.reset(e,t,n)}static get MAX_NODES(){return Math.pow(2,20)}get OPT_ERR_TRASHHOLD(){return j(this,v,"f")}get optimization(){return j(this,C,"f")}get clients(){return j(this,T,"f")}get allConnections(){return j(this,E,"f")}get allNodes(){return j(this,P,"f")}get WEIGHT_SHIFT_STRENGTH(){return j(this,c,"f")}get WEIGHT_RANDOM_STRENGTH(){return j(this,f,"f")}get PROBABILITY_MUTATE_LINK(){return j(this,p,"f")}get PROBABILITY_MUTATE_NODES(){return j(this,m,"f")}get PROBABILITY_MUTATE_WEIGHT_SHIFT(){return j(this,u,"f")}get PROBABILITY_MUTATE_WEIGHT_RANDOM(){return j(this,w,"f")}get PROBABILITY_MUTATE_TOGGLE_LINK(){return j(this,d,"f")}set CT(e){x(this,h,e,"f")}get CT(){return j(this,h,"f")}get CP(){return j(this,a,"f")}get C1(){return j(this,s,"f")}get C2(){return j(this,o,"f")}get C3(){return j(this,r,"f")}reset(e,t,n){x(this,g,e,"f"),x(this,b,t,"f"),x(this,_,n,"f"),j(this,E,"f").clear(),j(this,P,"f").clear(),x(this,T,[],"f"),this.CT=3*(e+t);for(let e=0;e<j(this,g,"f");e+=1){const t=this.getNode();t.x=.1,t.y=(e+1)/(j(this,g,"f")+1)}for(let e=0;e<j(this,b,"f");e+=1){const t=this.getNode();t.x=.9,t.y=(e+1)/(j(this,b,"f")+1)}for(let e=0;e<j(this,_,"f");e+=1){const e=new z.Client(this.emptyGenome());e.generateCalculator(),j(this,T,"f").push(e)}}setReplaceIndex(e,t,n){const i=new I.ConnectionGene(0,e,t).getHashKey(),s=j(this,E,"f").get(i);if(!s)throw new Error("setReplaceIndex to no connection");s.replaceIndex=n}getReplaceIndex(e,t){const n=new I.ConnectionGene(0,e,t).getHashKey(),i=j(this,E,"f").get(n);return i?i.replaceIndex:0}emptyGenome(){const e=new I.Genome(this);for(let t=0;t<j(this,g,"f")+j(this,b,"f");t+=1)e.nodes.add(this.getNode(t+1));return e}static getConnection(e){const t=new I.ConnectionGene(e.innovationNumber,e.from,e.to);return t.weight=e.weight,t.enabled=e.enabled,t}getConnection(e,t){const n=new I.ConnectionGene(0,e,t),i=n.getHashKey();if(j(this,E,"f").has(i)){const e=j(this,E,"f").get(i);n.innovationNumber=e?e.innovationNumber:0}else j(this,E,"f").set(i,n),n.innovationNumber=j(this,E,"f").size+1;return n}getNode(e){let t;if(e&&e<=j(this,P,"f").size()){if(t=j(this,P,"f").get(e-1),!(t instanceof I.NodeGene))throw new Error("getNode returns not a NodeGene")}else t=new I.NodeGene(j(this,P,"f").size()+1),j(this,P,"f").add(t);return t}printSpecies(){for(let e=0;e<j(this,M,"f").length;e+=1)console.log(j(this,M,"f")[e].score,j(this,M,"f")[e].size())}evolve(e=!1){var t;x(this,y,(t=j(this,y,"f"),++t),"f"),x(this,C,e||j(this,y,"f")%50==0,"f"),j(this,i,"m",S).call(this),j(this,i,"m",k).call(this),j(this,i,"m",O).call(this),j(this,i,"m",W).call(this),j(this,i,"m",G).call(this),j(this,i,"m",N).call(this);for(let e=0;e<j(this,T,"f").length;e+=1)j(this,T,"f")[e].generateCalculator()}},s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,h=new WeakMap,c=new WeakMap,f=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,w=new WeakMap,p=new WeakMap,m=new WeakMap,v=new WeakMap,g=new WeakMap,b=new WeakMap,_=new WeakMap,y=new WeakMap,T=new WeakMap,M=new WeakMap,E=new WeakMap,P=new WeakMap,C=new WeakMap,i=new WeakSet,N=function(){for(let e=0;e<j(this,T,"f").length;e+=1)j(this,T,"f")[e].mutate()},G=function(){const e=new R.RandomSelector(j(this,l,"f"));for(let t=0;t<j(this,M,"f").length;t+=1)e.add(j(this,M,"f")[t]);for(let t=0;t<j(this,T,"f").length;t+=1){const n=j(this,T,"f")[t];if(null===n.species){const t=e.random();n.genome=t.breed(),t.put(n,!0)}}e.reset()},W=function(){for(let e=j(this,M,"f").length-1;e>=0;e--)j(this,M,"f")[e].size()<=1&&!j(this,M,"f")[e].clients[0].bestScore&&(j(this,M,"f")[e].goExtinct(),j(this,M,"f").splice(e,1))},O=function(){for(let e=0;e<j(this,M,"f").length;e+=1)j(this,M,"f")[e].kill(j(this,l,"f"))},k=function(){for(let e=0;e<j(this,M,"f").length;e+=1)j(this,M,"f")[e].reset();for(let e=0;e<j(this,T,"f").length;e+=1){const t=j(this,T,"f")[e];if(null!==t.species)continue;let n=!1;for(let e=0;e<j(this,M,"f").length;e+=1)if(j(this,M,"f")[e].put(t)){n=!0;break}n||j(this,M,"f").push(new H.Species(t))}for(let e=0;e<j(this,M,"f").length;e+=1)j(this,M,"f")[e].evaluateScore(this.optimization)},S=function(){let e=0;const t=[];let n=1/0;for(let t=0;t<j(this,T,"f").length;t+=1){const i=j(this,T,"f")[t];i.bestScore=!1,e=i.score>e?i.score:e,n=i.score<n?i.score:n}for(let i=0;i<j(this,T,"f").length;i+=1){const s=j(this,T,"f")[i];s.score===e?(t.push(i),s.bestScore=!0,s.score=1):s.score===n?s.score=0:s.score=(s.score-n)/(e-n)}t.length>1&&t.forEach((e=>{j(this,T,"f")[e].bestScore=!1}));const i=j(this,C,"f")?.1:1e-4;j(this,T,"f").forEach((e=>{const t=e.genome.connections.size();e.score-=Math.sqrt(Math.sqrt(t))*i}))}},765:function(e,t,n){var i,s,o,r,a,h,c=this&&this.__classPrivateFieldSet||function(e,t,n,i,s){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,n):s?s.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Species=void 0;const l=n(329);t.Species=class{constructor(e){i.add(this),s.set(this,[]),o.set(this,void 0),r.set(this,0),a.set(this,!1),c(this,o,e,"f"),f(this,o,"f").species=this,f(this,s,"f").push(e)}get score(){return f(this,r,"f")}get clients(){return f(this,s,"f")}put(e,t=!1){return!!(t||e.distance(f(this,o,"f"))<f(this,o,"f").genome.neat.CP)&&(e.species=this,f(this,s,"f").push(e),!0)}goExtinct(){for(let e=0;e<f(this,s,"f").length;e+=1)f(this,s,"f")[e].species=null;c(this,s,[],"f")}evaluateScore(e){c(this,a,e,"f");let t=0;for(let e=0;e<f(this,s,"f").length;e+=1)t+=f(this,s,"f")[e].score;c(this,r,t/f(this,s,"f").length,"f")}reset(){c(this,o,f(this,i,"m",h).call(this),"f"),this.goExtinct(),f(this,s,"f").push(f(this,o,"f")),f(this,o,"f").species=this,c(this,r,0,"f")}kill(e=.5){f(this,s,"f").sort(((e,t)=>e.score>t.score?-1:1));const t=e*f(this,s,"f").length;for(let e=f(this,s,"f").length-1;e>t;e-=1)f(this,s,"f")[e].bestScore||(f(this,s,"f")[e].species=null,f(this,s,"f").splice(e,1))}breed(){const e=f(this,i,"m",h).call(this),t=f(this,i,"m",h).call(this);return e.score>=t.score?l.Genome.crossOver(e.genome,t.genome):l.Genome.crossOver(t.genome,e.genome)}size(){return f(this,s,"f").length}},s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,i=new WeakSet,h=function(){return f(this,s,"f")[Math.floor(Math.random()*f(this,s,"f").length)]}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.Neat=void 0;var t=n(983);Object.defineProperty(e,"Neat",{enumerable:!0,get:function(){return t.Neat}})})(),i})()));
//# sourceMappingURL=main.js.map